# Telegram Chatbot

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ
–≠—Ç–æ Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–æ–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –º–æ–¥–µ—Ä–∞—Ü–∏—é, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞ –º—É—Ç, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π **–ø—Ä–∏–≤–∞—Ç–Ω—ã–π**, –¥–æ—Å—Ç—É–ø –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã**:
  - `/start`: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è.
  - `/nick <–∏–º—è>`: –°–º–µ–Ω–∞ –Ω–∏–∫–∞.
  - `/poll <–≤–æ–ø—Ä–æ—Å>`: –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞.
  - `/rules`: –ü–æ–∫–∞–∑ –ø—Ä–∞–≤–∏–ª —á–∞—Ç–∞.
  - `/about`: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ.
  - `/ping`: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª–∏–∫–∞.
- **–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã**:
  - `/mute <@username>`: –ú—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `/unmute <@username>`: –°–Ω—è—Ç–∏–µ –º—É—Ç–∞.
  - `/vote_mute <@username>`: –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞ –º—É—Ç.
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**:
  - `/ban <@username> <–ø—Ä–∏—á–∏–Ω–∞>`: –ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `/unban <@username>`: –†–∞–∑–±–∞–Ω.
  - `/set_role <@username> <—Ä–æ–ª—å>`: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–æ–ª–∏ (admin, moderator, user).
  - `/view_logs <@username> [–ª–∏–º–∏—Ç]`: –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤.
  - `/set_mute_duration <–º–∏–Ω—É—Ç—ã>`: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º—É—Ç–∞.
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ª–æ–≥–æ–≤.
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `cryptography`.
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∫–æ–º–∞–Ω–¥ —Å `aiolimiter`.
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å `structlog`.

## üõ† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.12+
- Git, curl
- Telegram-—Ç–æ–∫–µ–Ω –æ—Ç [@BotFather](https://t.me/BotFather)
- –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `cryptography`)
- –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é (SSH-–∫–ª—é—á)
- VPS —Å Linux (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Ubuntu 22.04/24.04 LTS)

## üîí –î–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é
–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π. –î–ª—è –¥–æ—Å—Ç—É–ø–∞:
1. –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞ (`Samtagil`).
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH-–∫–ª—é—á:
   ```bash
   ssh-keygen -t ed25519 -C "your_email@example.com"
   cat ~/.ssh/id_ed25519.pub
   ```
   –î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ GitHub: Settings > SSH and GPG keys.
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø:
   ```bash
   ssh -T git@github.com
   ```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ [`INSTALL.md`](./INSTALL.md). –ö—Ä–∞—Ç–∫–æ:

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS:
   ```bash
   ssh root@your_vps_ip
   ```

2. –°–∫–∞—á–∞–π—Ç–µ `setup.sh`:
   ```bash
   curl -O https://raw.githubusercontent.com/Samtagil/Anonchatbot/main/setup.sh
   chmod +x setup.sh
   ```

3. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –∫–ª—é—á:
   - –¢–æ–∫–µ–Ω: —á–µ—Ä–µ–∑ @BotFather (`/newbot`).
   - –ö–ª—é—á:
     ```bash
     python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
     ```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É, —É–∫–∞–∑–∞–≤ –¥–∞–Ω–Ω—ã–µ:
   ```bash
   sudo bash setup.sh git@github.com:Samtagil/Anonchatbot.git your_bot_token your_encryption_key
   ```

5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:
   ```bash
   systemctl status chatbot.service
   ```

## üïπ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º**:
  ```bash
  sudo systemctl start chatbot.service   # –ó–∞–ø—É—Å–∫
  sudo systemctl stop chatbot.service    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
  sudo systemctl restart chatbot.service # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
  journalctl -u chatbot.service -f       # –õ–æ–≥–∏
  ```

- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
  - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º.
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/ping` (–æ—Ç–≤–µ—Ç: "Pong! üèì").
  - –ù–∞–∑–Ω–∞—á—å—Ç–µ —Å–µ–±–µ —Ä–æ–ª—å –∞–¥–º–∏–Ω–∞:
    ```sql
    sqlite3 /opt/chatbot/chatbot.db "UPDATE users SET role = 'admin' WHERE user_id = your_telegram_id;"
    ```
  - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ `/ban @username –°–ø–∞–º`.

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
  - `bot.py`: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è.
  - `config.py`: –ó–∞–≥—Ä—É–∑–∫–∞ `.env`.
  - `database.py`: –†–∞–±–æ—Ç–∞ —Å SQLite.
  - `user_commands.py`: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã.
  - `admin_commands.py`: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã.
  - `.env`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–æ–∫–µ–Ω, –∫–ª—é—á).
  - `.gitignore`: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
  ```bash
  pip install -r requirements.txt
  ```

- **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
  ```bash
  pip install black
  black .
  ```

- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
  ```bash
  pip install pytest
  pytest
  ```

## üîç –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫
- **–ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**:
  ```bash
  journalctl -u chatbot.service -n 100
  cat /var/log/chatbot_setup.log
  ```
- **–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é**:
  ```bash
  ssh -T git@github.com
  ```
- –°–º. [`INSTALL.md`](./INSTALL.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞.

## üì¨ –ö–æ–Ω—Ç–∞–∫—Ç—ã
–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–ª–∏ –≤–æ–ø—Ä–æ—Å–æ–≤: —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (`Samtagil`).
